<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Xizoa</title>

<link href="https://fonts.googleapis.com/css2?family=Grand+Hotel&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">

<style>
:root{
  --bg:#fafafa;--card:#fff;--text:#262626;
  --muted:#8e8e8e;--btn:#0095f6;--border:#dbdbdb;
}
*{box-sizing:border-box}
body{margin:0;font-family:Inter,sans-serif;background:var(--bg)}
.hidden{display:none}
.center{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:16px}
.card{background:var(--card);border:1px solid var(--border);border-radius:12px;width:100%;max-width:380px;padding:28px}
.logo{font-family:'Grand Hotel',cursive;font-size:3rem;text-align:center;margin-bottom:20px}
input,textarea{width:100%;padding:12px;margin-bottom:10px;border-radius:8px;border:1px solid var(--border)}
.btn{width:100%;padding:10px;border-radius:8px;border:none;background:var(--btn);color:#fff;font-weight:600;cursor:pointer}
.divider{text-align:center;color:var(--muted);margin:16px 0}
.social button{width:100%;padding:10px;border-radius:8px;font-weight:600;margin-bottom:8px;border:1px solid var(--border);background:#fff}
.social .github{background:#24292e;color:#fff;border:none}
.app{max-width:600px;margin:auto;padding:16px}
.feed-card{background:#fff;border:1px solid var(--border);border-radius:12px;padding:12px;margin-bottom:12px}
</style>
</head>

<body>

<div id="auth" class="center">
  <div class="card">
    <div class="logo">Xizoa</div>

    <input id="lUser" placeholder="Username">
    <input id="lPass" type="password" placeholder="Password">
    <button class="btn" onclick="login()">Log in</button>

    <div class="divider">OR</div>

    <div class="social">
      <button onclick="location.href=API+'/auth/google'">Continue with Google</button>
      <button class="github" onclick="location.href=API+'/auth/github'">Continue with GitHub</button>
    </div>
  </div>
</div>

<div id="app" class="hidden app">
  <textarea id="postText" placeholder="Write somethingâ€¦"></textarea>
  <button class="btn" onclick="post()">Post</button>
  <div id="feed"></div>
</div>

<script>
const API = "https://api.xizoa.com"; // YOUR WORKER DOMAIN
let me=null;

async function login(){
  const r = await fetch(API+"/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},
    body:JSON.stringify({username:lUser.value.trim(),password:lPass.value.trim()})});
  const d = await r.json();
  if(!d.success) return alert("Login failed");
  me=d.user;
  auth.classList.add("hidden");
  app.classList.remove("hidden");
  load();
}

async function post(){
  await fetch(API+"/posts/create",{method:"POST",headers:{"Content-Type":"application/json"},
    body:JSON.stringify({user_id:me.id,content:postText.value})});
  postText.value="";
  load();
}

async function load(){
  const r = await fetch(API+"/feed");
  const data = await r.json();
  feed.innerHTML="";
  data.forEach(p=>feed.innerHTML+=`<div class="feed-card"><b>${p.username}</b><br>${p.content}</div>`);
}
</script>

</body>
</html>